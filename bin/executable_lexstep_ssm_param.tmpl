#!/bin/bash
# File: lexstep_ssm_param 

if [ $# -eq 0 ]; then
    echo "Usage: $0 <ssm-parameter-name>"
    echo "Will prepend PROD/ to the start of the parameter name." 
    echo "...so if you want PROD/ALL/LEXSTEP_DB_HOST just put in ALL/LEXSTEP_DB_HOST"
    exit 1
fi

param_name="$1"

value=$(aws ssm get-parameters --name "PROD/$param_name" --with-decryption)

if [ $? -eq 0 ]; then
    echo -n "$value"
else
    echo "Error retrieving parameter $param_name" >&2
    exit 1
fi

